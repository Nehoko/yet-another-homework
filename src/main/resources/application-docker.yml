spring:
  config:
    activate:
      on-profile: docker
  datasource:
    # Use service DNS names inside Docker networks
    url: ${SPRING_DATASOURCE_URL:jdbc:postgresql://postgres:5432/pricing}
  data:
    redis:
      host: ${SPRING_DATA_REDIS_HOST:redis}
      port: ${SPRING_DATA_REDIS_PORT:6379}
      # Slightly higher timeout inside Docker networks
      timeout: 100ms

logging:
  level:
    root: INFO
    ge.imikhailov.omno.*: DEBUG
  pattern:
    # Adds traceId/spanId to logs for correlation
    level: "%5p [${spring.application.name:},%X{traceId:-},%X{spanId:-}]"

# OpenTelemetry Java starter settings for Docker.
# Disable log export because the collector is not configured for OTLP logs.
otel:
  service:
    name: ${spring.application.name}
  exporter:
    otlp:
      endpoint: http://otel-collector:4318
      protocol: http/protobuf
  logs:
    exporter: none
  traces:
    exporter: otlp

management:
  otlp:
    tracing:
      endpoint: http://otel-collector:4318/v1/traces
  metrics:
    distribution:
      percentiles:
        http:
          server:
            requests: 0.95,0.99
      slo:
        http:
          server:
            requests: 5ms,10ms,20ms,50ms,100ms,250ms,500ms,1s,2s,5s
  prometheus:
    metrics:
      export:
        enabled: true
